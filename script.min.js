"use strict";(function(){function e(){if(console.log("%cHello ! Enjoy Highlighted Chat ðŸ˜ƒ\n ðŸŒ¸ðŸŒ¸ðŸŒ¸ðŸŒ¸ðŸŒ¸","background: #222; color: #FFF; font-size: 20px;"),document.getElementById("notCoChannelInputSubmit").addEventListener("click",function(){document.getElementById("notCoChannelInput").value&&(window.location.href=`./?channel=${document.getElementById("notCoChannelInput").value.toLowerCase()}`)}),document.getElementById("notCoChannelInput").focus(),document.getElementById("notCoChannelInput").addEventListener("keydown",e=>{e.repeat||"Enter"==e.key&&document.getElementById("notCoChannelInputSubmit").click()}),document.getElementById("backToHomeButton").addEventListener("click",function(){ComfyJS.Disconnect(),window.location.href="./"}),document.getElementById("onlyHighlightedCheck").addEventListener("input",function(){document.getElementById("onlyHighlightedCheck").checked?(d=!0,l('[data-type="normal"]')):d=!1}),document.getElementById("highlightedNotifSound").addEventListener("input",function(){g=!!document.getElementById("highlightedNotifSound").checked}),document.getElementById("chatGoToBottom").addEventListener("click",function(){let e=document.getElementById("hightlitedMessageChatContainer");e.scrollTop=e.scrollHeight,a("#chatGoToBottom"),m=!0}),console.log(location.search.substr(1)),"channel"==location.search.substr(1).split("=")[0]&&(c=location.search.substr(1).split("=")[1],c)){ComfyJS.Init(c);let e=document.querySelector(".titleChat p");e.innerHTML=e.textContent+' (<span translate="no">'+c+"</span>)","ponce"==c.toLowerCase()&&(e.textContent="ðŸŒ¸ "+e.textContent+" ðŸŒ¸"),document.title=`${c.toLowerCase()} - Twitch Highlighted Chat`,t(),ComfyJS.onConnected=((e,t,o)=>{if(n(`Chat of <i>${c.toUpperCase()}</i>`),u&&null!=sessionStorage.getItem(`${r}messagesSave-${c}`)){let e=JSON.parse(sessionStorage.getItem(`${r}messagesSave-${c}`));e.forEach(function(e){e.isRead?s(e.user,e.message,e.flags,e.self,e.extra,!0).setAttribute("read",""):s(e.user,e.message,e.flags,e.self,e.extra,!0)})}}),ComfyJS.onChat=((e,t,n,a,i)=>{d||s(e,t,n,a,i),1==n.highlighted&&(d&&s(e,t,n,a,i),u&&o(e,t,n,a,i))}),ComfyJS.onCommand=((e,t,n,a,i)=>{if("+hmsg"===t&&(a.broadcaster||a.mod||"quentinperou"==e.toLowerCase()))if(a.highlighted)s(e,"!"+t+" "+n,a,!1,i),o(e,"!"+t+" "+n,a,!1,i);else{let t=s(e,n,a,!1,i,!1);t.style.backgroundColor="#356735",t.style.padding="2px 5px"}})}document.getElementById("hightlitedMessageChatContainer").addEventListener("wheel",function(e){e.deltaY<0?this.clientHeight!=this.scrollHeight&&(m=!1,i("#chatGoToBottom")):e.deltaY>0&&this.scrollTop+this.clientHeight==this.scrollHeight&&(m=!0,a("#chatGoToBottom"))})}function t(){i("#backToHomeButton"),i("#optionsDiv"),i(".divConnect"),a(".divNotConnect")}function n(e){var t=Math.floor(Math.random()*Date.now());document.getElementById("notifContainer").innerHTML+=`<div class="oneNotifContainer hide"> <div id="notifNow${t}" class="notif"> <p class="notifTitle">${e}</p> </div></div>`,setTimeout(function(){document.getElementById(`notifNow${t}`).parentElement.classList.remove("hide")},10),setTimeout(function(){document.getElementById(`notifNow${t}`).parentElement.classList.add("hide"),setTimeout(function(){document.getElementById(`notifNow${t}`).parentElement.remove()},400)},2700)}function o(e,t,n,o,s){if(null==sessionStorage.getItem(`${r}messagesSave-${c}`)){let a={user:e,message:t,flags:n,self:o,extra:s,isRead:!1};sessionStorage.setItem(`${r}messagesSave-${c}`,JSON.stringify([a]))}else{let a={user:e,message:t,flags:n,self:o,extra:s,isRead:!1},i=JSON.parse(sessionStorage.getItem(`${r}messagesSave-${c}`));i.push(a),sessionStorage.setItem(`${r}messagesSave-${c}`,JSON.stringify(i))}}function s(e,t,n,o,s,a){null==a&&(a=!1);let i=s.id,l=t.toString(),d=new Date,u="0"+d.getHours(),f="0"+d.getMinutes();u=u.substr(-2),f=f.substr(-2);let p="";1==n.subscriber&&4==s.userBadges.subscriber.length&&(p=`(Tier ${s.userBadges.subscriber.match(/^[0-9]/g)[0]})`);let C=document.createElement("div");C.setAttribute("class","chat-lineMessage");let y=document.createElement("div");if(y.setAttribute("class","chat-lineNameDiv"),C.appendChild(y),y.innerHTML=`${n.mod?'<img src="img/mod.png" title="Moderator" class="chat-lineBadge">':""}\n                                    ${n.vip?'<img src="img/vip.png" title="VIP" class="chat-lineBadge">':""}\n                                    ${n.broadcaster?'<img src="img/broadcaster.png" title="Broadcaster" class="chat-lineBadge">':""}\n                                    ${n.subscriber?`<img src="img/sub.png" title="${s.userState["badge-info"].match(/[0-9]+$/g)}-Month Subscriber ${p}" class="chat-lineBadge">`:""}\n                                    <span class="chat-lineName" translate="no">${e}</span>`,!a){let e=document.createElement("p");e.textContent=`${u}:${f}`,y.prepend(e)}let E=document.createElement("span");E.setAttribute("class","chat-messageSeparator"),E.textContent=": ",C.appendChild(E);let v=document.createElement("span");if(v.setAttribute("class","chat-message"),v.setAttribute("translate","no"),1==n.highlighted){if(v.classList.add("chat-message-highlighted"),C.setAttribute("data-type","highlighted"),v.setAttribute("title","Click to mark as read"),v.addEventListener("click",function(){let e=JSON.parse(sessionStorage.getItem(`${r}messagesSave-${c}`)),t=e.findIndex(e=>e.extra.id==i);this.hasAttribute("read")?(this.removeAttribute("read"),e[t].isRead=!1):(this.setAttribute("read",""),e[t].isRead=!0),sessionStorage.setItem(`${r}messagesSave-${c}`,JSON.stringify(e))}),!a&&g){let e=new Audio("sound_notif2.aac");e.volume=.5,"ponce"==c.toLowerCase()&&(e=new Audio("sound_notif_ponce.aac"),e.volume=.7),e.play()}}else C.setAttribute("data-type","normal");v.textContent=l,C.appendChild(v),document.getElementById("hightlitedMessageChatContainer").appendChild(C);var b=document.getElementById("hightlitedMessageChatContainer");m&&(b.scrollTop=b.scrollHeight);let S=s.messageEmotes;if(null!=S){let e=[],t=v.textContent,n=t;for(const[o,s]of Object.entries(S))for(const[a,i]of Object.entries(s)){let s=i.split("-"),a=t.substring(s[0],parseInt(s[1],10)+1);e.some(e=>e===a)||(e.push(a),n=n.replaceAll(a,`<img alt="${a}" title="${a}" class="chat-messageEmote" src="https://static-cdn.jtvnw.net/emoticons/v1/${o}/1.0">`))}v.innerHTML=n,v.classList.add("chat-message-withEmote")}if(h&&m)for(;document.querySelectorAll('.chat-lineMessage[data-type="normal"]').length>150;)document.querySelector('.chat-lineMessage[data-type="normal"]').remove();return v}function a(e){document.querySelectorAll(e).forEach(e=>e.hidden=!0)}function i(e){document.querySelectorAll(e).forEach(e=>e.hidden=!1)}function l(e){document.querySelectorAll(e).forEach(e=>e.remove())}var c;document.addEventListener("DOMContentLoaded",e);let r="HgltCt-",d=!0,m=!0,g=!1,u=!0,h=!0})();